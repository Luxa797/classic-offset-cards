import{r as a,E as e,J as y,I as f,L as g,_ as j}from"./index-DM-CIWAp.js";import{C as x}from"./Card-Cs5NGpgY.js";import{I as N}from"./Input-C5fRLLhS.js";import{B as b}from"./Button-CSkHMulG.js";import{S as _}from"./search-CuRiBKad.js";import{E as w}from"./eye-DucQexOi.js";const C=()=>{const[d,p]=a.useState([]),[h,c]=a.useState(!0),[n,o]=a.useState(null),[l,u]=a.useState("");a.useEffect(()=>{(async()=>{c(!0),o(null);try{const{data:s,error:r}=await j.from("all_order_summary").select("order_id, customer_name, customer_phone, total_amount, amount_paid, balance_due").order("order_id",{ascending:!1});if(r)throw r;p(s||[])}catch(s){console.error("Error fetching invoice data:",s),o(`Failed to load invoices. Details: ${JSON.stringify(s,null,2)}`)}finally{c(!1)}})()},[]);const i=a.useMemo(()=>{if(!l)return d;const t=l.toLowerCase();return d.filter(s=>{var r,m;return((r=s.customer_name)==null?void 0:r.toLowerCase().includes(t))||((m=s.customer_phone)==null?void 0:m.includes(t))||String(s.order_id).includes(t)})},[d,l]);return h?e.jsx("div",{className:"flex justify-center items-center p-10",children:e.jsx(y,{className:"w-8 h-8 animate-spin text-primary-500"})}):n?e.jsxs(x,{className:"p-6 m-4 bg-red-50 text-red-700 border border-red-300 text-center",children:[e.jsx(f,{className:"w-10 h-10 mx-auto mb-2 text-red-500"}),e.jsx("p",{className:"font-semibold",children:"Error Loading Data"}),e.jsx("pre",{className:"text-sm text-left whitespace-pre-wrap",children:n})]}):e.jsxs("div",{className:"p-4 sm:p-6 space-y-6",children:[e.jsx("h1",{className:"text-xl sm:text-2xl font-bold text-gray-800 dark:text-white",children:"ðŸ§¾ All Invoices"}),e.jsxs(x,{children:[e.jsx("div",{className:"p-4",children:e.jsxs("div",{className:"relative w-full sm:w-1/2 md:w-1/3",children:[e.jsx("span",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(_,{className:"w-5 h-5 text-gray-400 dark:text-gray-500"})}),e.jsx(N,{id:"search-invoices",type:"search",placeholder:"Search by Customer, Phone or Order ID...",value:l,onChange:t=>u(t.target.value),className:"w-full pl-10"})]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full table-auto text-sm",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700/50 text-gray-600 dark:text-gray-300",children:e.jsxs("tr",{className:"text-left",children:[e.jsx("th",{className:"px-4 py-3 font-medium",children:"Order ID"}),e.jsx("th",{className:"px-4 py-3 font-medium",children:"Customer"}),e.jsx("th",{className:"px-4 py-3 font-medium",children:"Phone"}),e.jsx("th",{className:"px-4 py-3 font-medium",children:"Total"}),e.jsx("th",{className:"px-4 py-3 font-medium",children:"Paid"}),e.jsx("th",{className:"px-4 py-3 font-medium",children:"Balance"}),e.jsx("th",{className:"px-4 py-3 font-medium",children:"Status"}),e.jsx("th",{className:"px-4 py-3 font-medium text-center",children:"View"})]})}),e.jsxs("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:[i.map(t=>e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700/50",children:[e.jsxs("td",{className:"px-4 py-3",children:["#",t.order_id]}),e.jsx("td",{className:"px-4 py-3 font-medium text-gray-800 dark:text-gray-100",children:t.customer_name||"-"}),e.jsx("td",{className:"px-4 py-3 text-gray-600 dark:text-gray-300",children:t.customer_phone||"-"}),e.jsxs("td",{className:"px-4 py-3",children:["â‚¹",t.total_amount.toLocaleString("en-IN")]}),e.jsxs("td",{className:"px-4 py-3 text-green-600",children:["â‚¹",t.amount_paid.toLocaleString("en-IN")]}),e.jsxs("td",{className:`px-4 py-3 font-bold ${t.balance_due>0?"text-red-600":"text-green-600"}`,children:["â‚¹",t.balance_due.toLocaleString("en-IN")]}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 text-xs rounded-full font-semibold
                        ${t.balance_due<=0?"bg-green-100 text-green-800 dark:bg-green-800/30 dark:text-green-200":t.amount_paid>0?"bg-yellow-100 text-yellow-800 dark:bg-yellow-800/30 dark:text-yellow-200":"bg-red-100 text-red-800 dark:bg-red-800/30 dark:text-red-200"}`,children:t.balance_due<=0?"Paid":t.amount_paid>0?"Partial":"Due"})}),e.jsx("td",{className:"px-4 py-3 text-center",children:e.jsx(g,{to:`/invoices/${t.order_id}`,children:e.jsx(b,{variant:"icon",size:"sm",title:"View Invoice",children:e.jsx(w,{className:"w-4 h-4 text-primary-600"})})})})]},t.order_id)),i.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:8,className:"text-center py-10 text-gray-500 dark:text-gray-400",children:"No invoices found."})})]})]})})]})]})};export{C as default};
