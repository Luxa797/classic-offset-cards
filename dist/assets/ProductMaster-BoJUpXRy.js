import{r as d,E as e,J as B,$ as S,_ as v,a0 as N}from"./index-DM-CIWAp.js";import{C as P}from"./Card-Cs5NGpgY.js";import{I as b}from"./Input-C5fRLLhS.js";import{S as I}from"./Select-BRlx7a9F.js";import{T as A}from"./TextArea-JRPRJW7n.js";import{B as p}from"./Button-CSkHMulG.js";import{S as q}from"./search-CuRiBKad.js";import{E as k}from"./eye-DucQexOi.js";import{S as w}from"./square-pen-Ctp6C1gD.js";import{T as C}from"./trash-2-BDU6yBnr.js";import{T as z}from"./tag-B0K0DeuI.js";import{F as L}from"./file-x-DcB5xnML.js";import{M}from"./Modal-vVolvInd.js";import{A as V}from"./align-left-DIgIGL_K.js";import{C as U}from"./ConfirmationModal-K-Eb6b0a.js";const $=({editingProduct:t,onSave:h,onCancel:l,isLoading:n})=>{const[r,a]=d.useState({name:"",unit_price:"",description:"",category:""});d.useEffect(()=>{a(t?{name:t.name||"",unit_price:String(t.unit_price||""),description:t.description||"",category:t.category||""}:{name:"",unit_price:"",description:"",category:""})},[t]);const c=x=>{const{id:s,value:o}=x.target;a(y=>({...y,[s]:o}))},m=x=>{if(x.preventDefault(),!r.name||!r.unit_price||!r.category){alert("Please fill all required fields.");return}h({...r,unit_price:parseFloat(r.unit_price)})},g=[{value:"Business Cards",label:"Business Cards"},{value:"Invitation Cards",label:"Invitation Cards"},{value:"Flyers",label:"Flyers"},{value:"Brochures",label:"Brochures"},{value:"Posters",label:"Posters"},{value:"Banners",label:"Banners"},{value:"Booklets",label:"Booklets"}];return e.jsx(P,{id:"product-form-card",children:e.jsxs("div",{className:"p-5",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 dark:text-white mb-4",children:t?"âœï¸ Edit Product":" Add New Product"}),e.jsxs("form",{onSubmit:m,className:"space-y-4",children:[e.jsx(b,{id:"name",label:"Product Name *",value:r.name,onChange:c,required:!0,disabled:n}),e.jsx(b,{id:"unit_price",label:"Unit Price (â‚¹) *",type:"number",step:"0.01",value:r.unit_price,onChange:c,required:!0,disabled:n}),e.jsx(I,{id:"category",label:"Category *",value:r.category,onChange:c,options:g,required:!0,disabled:n,placeholder:"Select a category"}),e.jsx(A,{id:"description",label:"Description",value:r.description,onChange:c,disabled:n}),e.jsxs("div",{className:"flex justify-end gap-3 pt-2",children:[e.jsx(p,{type:"button",variant:"outline",onClick:l,disabled:n,children:"Cancel"}),e.jsx(p,{type:"submit",variant:"primary",disabled:n,children:n?e.jsx(B,{className:"w-5 h-5 animate-spin"}):t?"Update Product":"Save Product"})]})]})]})})},O=({products:t,loading:h,onView:l,onEdit:n,onDelete:r})=>{const[a,c]=d.useState(""),m=d.useMemo(()=>{if(!a)return t;const s=a.toLowerCase();return t.filter(o=>o.name.toLowerCase().includes(s)||o.category.toLowerCase().includes(s))},[t,a]),g=()=>e.jsx("div",{className:"p-4 space-y-3 animate-pulse",children:Array(5).fill(0).map((s,o)=>e.jsx("div",{className:"flex justify-between items-center h-12 bg-gray-200 dark:bg-gray-700 rounded-md"},o))}),x=()=>e.jsxs("div",{className:"text-center py-16 text-gray-500 dark:text-gray-400",children:[e.jsx(L,{size:48,className:"mx-auto mb-4"}),e.jsx("h3",{className:"font-semibold",children:"No Products Found"}),e.jsx("p",{className:"text-sm",children:a?"Try adjusting your search term.":"Add your first product using the form."})]});return e.jsxs(P,{children:[e.jsxs("div",{className:"p-4 flex flex-col md:flex-row justify-between items-center gap-4 border-b dark:border-gray-700",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 dark:text-white self-start md:self-center",children:"Product / Service List"}),e.jsxs("div",{className:"relative w-full md:w-auto md:min-w-64",children:[e.jsx("span",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(q,{className:"w-5 h-5 text-gray-400"})}),e.jsx(b,{id:"search-products",placeholder:"Search by name or category...",value:a,onChange:s=>c(s.target.value),className:"w-full pl-10"})]})]}),h?e.jsx(g,{}):e.jsxs("div",{children:[e.jsx("div",{className:"md:hidden p-4 space-y-3",children:m.length>0?m.map(s=>e.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-700/50 rounded-lg border dark:border-gray-600",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx("span",{className:"font-bold text-gray-800 dark:text-white break-all",children:s.name}),e.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[e.jsx(p,{variant:"icon",size:"sm",onClick:()=>l(s),title:"View",children:e.jsx(k,{size:16})}),e.jsx(p,{variant:"icon",size:"sm",onClick:()=>n(s),title:"Edit",children:e.jsx(w,{size:16})}),e.jsx(p,{variant:"icon",size:"sm",onClick:()=>r(s),title:"Delete",children:e.jsx(C,{size:16,className:"text-red-500"})})]})]}),e.jsxs("div",{className:"mt-2 text-xs text-gray-500 dark:text-gray-400 space-y-1",children:[e.jsxs("p",{className:"flex items-center gap-2",children:[e.jsx(z,{size:14})," ",s.category]}),e.jsxs("p",{className:"flex items-center gap-2 font-semibold",children:[e.jsx(S,{size:14})," â‚¹",s.unit_price.toLocaleString("en-IN")]})]})]},s.id)):e.jsx(x,{})}),e.jsx("div",{className:"overflow-x-auto hidden md:block",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{className:"text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3",children:"Name"}),e.jsx("th",{className:"px-4 py-3",children:"Category"}),e.jsx("th",{className:"px-4 py-3 text-right",children:"Unit Price"}),e.jsx("th",{className:"px-4 py-3 text-center",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:m.length>0?m.map(s=>e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700/50",children:[e.jsx("td",{className:"px-4 py-3 font-medium text-gray-800 dark:text-white",children:s.name}),e.jsx("td",{className:"px-4 py-3 text-gray-600 dark:text-gray-300",children:s.category}),e.jsxs("td",{className:"px-4 py-3 text-right font-semibold",children:["â‚¹",s.unit_price.toLocaleString("en-IN")]}),e.jsxs("td",{className:"px-4 py-3 text-center space-x-1",children:[e.jsx(p,{variant:"icon",size:"sm",title:"View Product",onClick:()=>l(s),children:e.jsx(k,{size:16})}),e.jsx(p,{variant:"icon",size:"sm",title:"Edit Product",onClick:()=>n(s),children:e.jsx(w,{size:16})}),e.jsx(p,{variant:"icon",size:"sm",title:"Delete Product",onClick:()=>r(s),children:e.jsx(C,{size:16,className:"text-red-500"})})]})]},s.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:4,children:e.jsx(x,{})})})})]})})]})]})},R=({isOpen:t,onClose:h,product:l})=>!t||!l?null:e.jsx(M,{isOpen:t,onClose:h,title:l.name,size:"lg",children:e.jsxs("div",{className:"space-y-4 pt-2",children:[e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg",children:[e.jsx(z,{className:"w-5 h-5 text-primary-600 dark:text-primary-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Category"}),e.jsx("p",{className:"font-medium text-gray-800 dark:text-gray-100",children:l.category})]})]}),e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg",children:[e.jsx(S,{className:"w-5 h-5 text-green-600 dark:text-green-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Unit Price"}),e.jsxs("p",{className:"font-medium text-gray-800 dark:text-gray-100",children:["â‚¹",l.unit_price.toLocaleString("en-IN")]})]})]}),l.description&&e.jsxs("div",{className:"p-3",children:[e.jsxs("p",{className:"text-xs font-semibold text-gray-600 dark:text-gray-400 flex items-center gap-2 mb-1",children:[e.jsx(V,{size:16}),"Description"]}),e.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300 whitespace-pre-wrap",children:l.description})]})]})}),le=()=>{const[t,h]=d.useState([]),[l,n]=d.useState(!0),[r,a]=d.useState(!1),[c,m]=d.useState(null),[g,x]=d.useState(null),[s,o]=d.useState(null),y=d.useCallback(async()=>{n(!0);try{const{data:i,error:u}=await v.from("products").select("*").order("created_at",{ascending:!1});if(u)throw u;h(i||[])}catch(i){N.error(i.message||"Failed to fetch products.")}finally{n(!1)}},[]);d.useEffect(()=>{y()},[y]);const T=async i=>{a(!0);const u=c?v.from("products").update(i).eq("id",c.id):v.from("products").insert(i);N.promise(u,{loading:c?"Updating product...":"Adding product...",success:f=>{if(f.error)throw f.error;return m(null),y(),a(!1),`Product "${i.name}" ${c?"updated":"added"}!`},error:f=>(a(!1),f.message||"Failed to save product.")})},_=i=>{var u;m(i),(u=document.getElementById("product-form-card"))==null||u.scrollIntoView({behavior:"smooth"})},E=i=>{o(i)},D=async()=>{if(!s)return;const i=s.name,u=s.id;a(!0);const f=v.from("products").delete().eq("id",u);N.promise(f,{loading:"Deleting product...",success:j=>{if(j.error)throw j.error;return y(),a(!1),o(null),`Product "${i}" deleted.`},error:j=>(a(!1),o(null),j.message||"Failed to delete product.")})},F=i=>{x(i)};return e.jsxs("div",{className:"p-4 sm:p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800 dark:text-white",children:"ðŸ“¦ Products & Services"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-sm",children:"Manage all items you offer to customers."})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 items-start",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsx(O,{products:t,loading:l,onView:F,onEdit:_,onDelete:E})}),e.jsx("div",{className:"lg:col-span-1",id:"product-form-card",children:e.jsx($,{editingProduct:c,onSave:T,onCancel:()=>m(null),isLoading:r})})]}),e.jsx(U,{isOpen:!!s,onClose:()=>o(null),onConfirm:D,title:"Confirm Deletion",description:`Are you sure you want to delete "${s==null?void 0:s.name}"? This action cannot be undone.`,confirmText:"Delete",isLoading:r}),e.jsx(R,{isOpen:!!g,onClose:()=>x(null),product:g})]})};export{le as default};
